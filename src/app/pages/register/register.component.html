<form class="add-task-form" [formGroup]="registerForm" (ngSubmit)="onSubmit($event)" novalidate>
  <fieldset class="fieldset">
    <legend class="form__legend">Registrate</legend>
    <app-button class="form-close" aria-label="Cerrar" (click)="close($event)">✕</app-button>
    <app-form-input
      formControlName="email"
      type="email"
      name="email"
      placeholder="Correo electrónico"
      [required]="true"
    ></app-form-input>
    <article class="error" *ngIf="registerForm.get('email')?.touched && registerForm.get('email')?.invalid">
      <small *ngIf="registerForm.get('email')?.errors?.['required']">El correo es obligatorio.</small>
      <small *ngIf="registerForm.get('email')?.errors?.['email']">Correo no válido.</small>
      <small *ngIf="registerForm.get('email')?.errors?.['emailTaken']">Correo ya registrado.</small>
    </article>
    <section class="flex">
      <section>
        <app-form-input
          formControlName="username"
          name="username"
          placeholder="Nombre de usuario"
          [required]="true"
        ></app-form-input>
        <article class="error" *ngIf="registerForm.get('username')?.touched && registerForm.get('username')?.invalid">
          <small *ngIf="registerForm.get('username')?.errors?.['required']">El usuario es obligatorio.</small>
          <small *ngIf="registerForm.get('username')?.errors?.['usernameTaken']">Usuario ya existe.</small>
        </article>
        <app-form-input
          formControlName="name"
          name="name"
          placeholder="Nombre"
          [required]="true"
        ></app-form-input>
        <article class="error" *ngIf="registerForm.get('name')?.touched && registerForm.get('name')?.invalid">
          <small>Nombre obligatorio</small>
        </article>
      </section>
      <section>
        <app-form-input
          formControlName="surnames"
          name="surnames"
          placeholder="Apellidos"
          [required]="true"
        ></app-form-input>
        <article class="error" *ngIf="registerForm.get('surnames')?.touched && registerForm.get('surnames')?.invalid">
          <small>Apellidos obligatorios</small>
        </article>
        <app-form-input
          formControlName="phoneNumber"
          type="tel"
          name="phoneNumber"
          placeholder="Teléfono"
          [required]="true"
        ></app-form-input>
        <article class="error" *ngIf="registerForm.get('phoneNumber')?.touched && registerForm.get('phoneNumber')?.invalid">
          <small *ngIf="registerForm.get('phoneNumber')?.errors?.['required']">Teléfono obligatorio.</small>
          <small *ngIf="registerForm.get('phoneNumber')?.errors?.['invalidPhoneNumber']">Teléfono no válido.</small>
        </article>
      </section>
    </section>
    <app-form-input
      formControlName="password"
      type="password"
      name="password"
      placeholder="Contraseña"
      [required]="true"
    ></app-form-input>
    <article class="error" *ngIf="registerForm.get('password')?.touched && registerForm.get('password')?.invalid">
      <small *ngIf="registerForm.get('password')?.errors?.['required']">Contraseña obligatoria.</small>
      <small *ngIf="registerForm.get('password')?.errors?.['minLength']">Debe tener al menos 8 caracteres.</small>
      <small *ngIf="registerForm.get('password')?.errors?.['noUppercase']">Debe incluir una mayúscula.</small>
      <small *ngIf="registerForm.get('password')?.errors?.['noLowercase']">Debe incluir una minúscula.</small>
      <small *ngIf="registerForm.get('password')?.errors?.['noNumber']">Debe incluir un número.</small>
      <small *ngIf="registerForm.get('password')?.errors?.['noSpecial']">Debe incluir un carácter especial.</small>
    </article>

    <app-form-input
      formControlName="repeatPassword"
      type="password"
      name="repeatPassword"
      placeholder="Repetir contraseña"
      [required]="true"
    ></app-form-input>
    <article class="error" *ngIf="registerForm.errors?.['mismatch'] && registerForm.get('repeatPassword')?.touched">
      <small>Las contraseñas no coinciden.</small>
    </article>
    <article class="grid-center">
      <app-button type="submit" class="grid" [disabled]="registerForm.invalid || registerForm.pending || loading"><ng-container *ngIf="!loading">Registrate</ng-container><ng-container *ngIf="loading">Registrando...</ng-container></app-button>
      <a (click)="openLogin($event)">¿Ya tienes cuenta? Iniciar sesión</a>
    </article>
  </fieldset>
</form>
